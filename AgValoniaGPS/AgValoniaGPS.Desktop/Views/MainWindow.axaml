<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="using:AgValoniaGPS.ViewModels"
        mc:Ignorable="d" d:DesignWidth="1366" d:DesignHeight="768"
        x:Class="AgValoniaGPS.Desktop.Views.MainWindow"
        x:DataType="vm:MainViewModel"
        Icon="/Assets/avalonia-logo.ico"
        Title="AgValoniaGPS"
        Width="1366" Height="768"
        WindowState="Maximized"
        Background="#1a1a1a">

    <!-- Main Layout: Custom Status Bar + Content Area -->
    <Grid RowDefinitions="Auto,*">

        <!-- Custom Top Status Bar (matches old AgOpenGPS) -->
        <Border Grid.Row="0" Background="#1a1a1a" Height="60" BorderThickness="0">
            <Grid ColumnDefinitions="Auto,Auto,Auto,*,Auto,Auto,Auto,Auto,Auto">

                <!-- Section Control Indicator (3 colored bars) -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" Margin="8,0,12,0" VerticalAlignment="Center">
                    <Rectangle Width="40" Height="8" Fill="#90EE90" Margin="0,0,2,0"/>
                    <Rectangle Width="40" Height="8" Fill="#FFD700" Margin="0,0,2,0"/>
                    <Rectangle Width="40" Height="8" Fill="#FF6B6B"/>
                </StackPanel>

                <!-- GPS Status -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="8,0" VerticalAlignment="Center">
                    <Image Source="/Assets/Icons/GPSQuality.png" Width="28" Height="28" Margin="0,0,6,0"/>
                    <TextBlock Text="RTK fix: Age: 0.0" VerticalAlignment="Center" FontSize="13" Foreground="White"/>
                </StackPanel>

                <!-- Rotating Information Display with Play/Pause Button -->
                <Border Grid.Column="2" Background="#2a2a2a" BorderBrush="#808080" BorderThickness="1"
                        Padding="10,6" Margin="6,0" CornerRadius="2">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <TextBlock Text="▶" FontSize="14" VerticalAlignment="Center" Foreground="White"/>
                        <TextBlock Text="Line: No Guidance Lines" FontSize="13" VerticalAlignment="Center"
                                   Foreground="White" FontWeight="SemiBold"/>
                    </StackPanel>
                </Border>

                <!-- Speed Display -->
                <Border Grid.Column="4" Background="#FFE4B5" Padding="14,8" Margin="6,0" CornerRadius="2">
                    <TextBlock Text="{Binding Speed, StringFormat={}{0:F2}}" FontSize="18" FontWeight="Bold"
                               Foreground="Black" VerticalAlignment="Center"/>
                </Border>

                <!-- GPS Signal Strength / Satellite Count -->
                <Border Grid.Column="5" Background="White" Padding="10,6" Margin="6,0" CornerRadius="2">
                    <TextBlock Text="{Binding SatelliteCount}" FontSize="15" FontWeight="Bold"
                               Foreground="Black" VerticalAlignment="Center"/>
                </Border>

                <!-- Orange Progress Bar -->
                <ProgressBar Grid.Column="6" Width="100" Height="8" Value="65" Maximum="100"
                             Foreground="#FF8C00" Background="#E0E0E0" Margin="6,0" VerticalAlignment="Center"/>

                <!-- Minimize Button -->
                <Button Grid.Column="7" Width="44" Height="44" Background="Transparent"
                        BorderThickness="0" Margin="4,0,0,0"
                        Content="−" FontSize="24" FontWeight="Bold" Foreground="Black"/>

                <!-- Close Button -->
                <Button Grid.Column="8" Width="44" Height="44" Background="#DC3545"
                        BorderThickness="0" Margin="4,0,8,0"
                        Content="✕" FontSize="20" FontWeight="Bold" Foreground="White"/>
            </Grid>
        </Border>

        <!-- Main Content Area: Docking Panels + OpenGL Map -->
        <Grid Grid.Row="1" ColumnDefinitions="72,*,70" RowDefinitions="*,62">

            <!-- Panel Left: Vertical toolbar (7 icons matching original AgOpenGPS) -->
            <Border Grid.Column="0" Grid.Row="0" Background="#1a1a1a">
                <StackPanel x:Name="PanelLeft"
                           Spacing="8"
                           VerticalAlignment="Top"
                           Margin="0,8,0,0">

                <!-- 1. Navigation Settings icon -->
                <Button Width="68" Height="62" Background="Transparent" BorderThickness="0" Padding="8"
                        ToolTip.Tip="Navigation Settings">
                    <Image Source="/Assets/Icons/NavigationSettings.png" Width="52" Height="46"/>
                </Button>

                <!-- 2. Wizards/Special Functions menu icon -->
                <Button Width="68" Height="68" Background="Transparent" BorderThickness="0" Padding="8"
                        ToolTip.Tip="Wizards Menu">
                    <Image Source="/Assets/Icons/SpecialFunctions.png" Width="52" Height="52"/>
                </Button>

                <!-- 3. Configuration menu icon -->
                <Button Width="68" Height="68" Background="Transparent" BorderThickness="0" Padding="8"
                        ToolTip.Tip="Configuration">
                    <Image Source="/Assets/Icons/Settings48.png" Width="52" Height="52"/>
                </Button>

                <!-- 4. Field/Job menu icon -->
                <Button Width="68" Height="68" Background="Transparent" BorderThickness="0" Padding="8"
                        ToolTip.Tip="Field Manager">
                    <Image Source="/Assets/Icons/JobActive.png" Width="52" Height="52"/>
                </Button>

                <!-- 5. Field Tools menu icon -->
                <Button Width="68" Height="68" Background="Transparent" BorderThickness="0" Padding="8"
                        ToolTip.Tip="Field Tools Menu">
                    <Image Source="/Assets/Icons/FieldTools.png" Width="52" Height="52"/>
                </Button>

                <!-- 6. Autosteer config button with live steer angle display -->
                <Button Width="68" Height="76" Background="Transparent" BorderThickness="0" Padding="4"
                        ToolTip.Tip="Auto Steer Configuration">
                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                        <TextBlock Text="0.0" FontSize="16" FontWeight="Bold" Foreground="White"
                                   HorizontalAlignment="Center"/>
                        <TextBlock Text="0.0" FontSize="16" FontWeight="Bold" Foreground="White"
                                   HorizontalAlignment="Center" Margin="0,4,0,0"/>
                    </StackPanel>
                </Button>

                <!-- 7. Data I/O status button (module status and RTCM) -->
                <Button Width="68" Height="82" Background="Transparent" BorderThickness="0" Padding="8"
                        ToolTip.Tip="Data I/O Status">
                    <Image Source="/Assets/Icons/AgIO.png" Width="52" Height="66"/>
                </Button>
                </StackPanel>
            </Border>

            <!-- OpenGL Map Placeholder (Column 1, Row 0) -->
            <Border Grid.Column="1" Grid.Row="0"
                    x:Name="MapContainer"
                    Background="Black">
                <!-- OpenGL map control will be rendered here in Wave 11 -->
                <TextBlock Text="OpenGL Map Area (Wave 11)"
                          Foreground="#555"
                          FontSize="24"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Center"/>
            </Border>

            <!-- Panel Right: Vertical toolbar (bottom-aligned, reversed order for BottomUp flow) -->
            <Border Grid.Column="2" Grid.Row="0" Background="#1a1a1a" VerticalAlignment="Bottom">
                <StackPanel x:Name="PanelRight"
                           Spacing="6">

                <!-- 9. Contour Lock toggle -->
                <Button Width="66" Height="66" Background="Transparent" BorderThickness="0" Padding="6"
                        ToolTip.Tip="Contour Lock">
                    <Image Source="/Assets/Icons/ColorUnlocked.png" Width="54" Height="54"/>
                </Button>

                <!-- 8. Contour toggle -->
                <Button Width="66" Height="66" Background="Transparent" BorderThickness="0" Padding="6"
                        ToolTip.Tip="Contour Mode">
                    <Image Source="/Assets/Icons/ContourOff.png" Width="54" Height="54"/>
                </Button>

                <!-- 7. Cycle Lines Forward -->
                <Button Width="66" Height="66" Background="Transparent" BorderThickness="0" Padding="6"
                        ToolTip.Tip="Cycle Lines Forward">
                    <Image Source="/Assets/Icons/ABLineCycle.png" Width="54" Height="54"/>
                </Button>

                <!-- 6. Cycle Lines Backward -->
                <Button Width="66" Height="66" Background="Transparent" BorderThickness="0" Padding="6"
                        ToolTip.Tip="Cycle Lines Backward">
                    <Image Source="/Assets/Icons/ABLineCycleBk.png" Width="54" Height="54"/>
                </Button>

                <!-- 5. Auto Track toggle -->
                <Button Width="66" Height="66" Background="Transparent" BorderThickness="0" Padding="6"
                        ToolTip.Tip="Auto Track">
                    <Image Source="/Assets/Icons/AutoTrackOff.png" Width="54" Height="54"/>
                </Button>

                <!-- 4. Section Master Manual toggle -->
                <Button Width="66" Height="66" Background="Transparent" BorderThickness="0" Padding="6"
                        ToolTip.Tip="Section Control Manual">
                    <Image Source="/Assets/Icons/ManualOff.png" Width="54" Height="54"/>
                </Button>

                <!-- 3. Section Master Auto toggle -->
                <Button Width="66" Height="66" Background="Transparent" BorderThickness="0" Padding="6"
                        ToolTip.Tip="Section Control Auto">
                    <Image Source="/Assets/Icons/SectionMasterOff.png" Width="54" Height="54"/>
                </Button>

                <!-- 2. Auto YouTurn toggle -->
                <Button Width="66" Height="66" Background="Transparent" BorderThickness="0" Padding="6"
                        ToolTip.Tip="Auto YouTurn">
                    <Image Source="/Assets/Icons/YouTurnNo.png" Width="54" Height="54"/>
                </Button>

                <!-- 1. Auto Steer toggle -->
                <Button Width="66" Height="66" Background="Transparent" BorderThickness="0" Padding="6"
                        ToolTip.Tip="Auto Steer">
                    <Image Source="/Assets/Icons/AutoSteerOff.png" Width="54" Height="54"/>
                </Button>
                </StackPanel>
            </Border>

            <!-- Panel Bottom: Horizontal toolbar (right-aligned, reversed order for RightToLeft flow) -->
            <Border Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="3" Background="#1a1a1a" HorizontalAlignment="Right">
                <StackPanel x:Name="PanelBottom"
                           Orientation="Horizontal"
                           Spacing="6">

                <!-- 11. YouTurn Skip Enable toggle -->
                <Button Width="58" Height="58" Background="Transparent" BorderThickness="0" Padding="5"
                        ToolTip.Tip="YouTurn Skip">
                    <Image Source="/Assets/Icons/YouSkipOff.png" Width="48" Height="48"/>
                </Button>

                <!-- 10. Change Mapping Color -->
                <Button Width="58" Height="58" Background="Transparent" BorderThickness="0" Padding="5"
                        ToolTip.Tip="Section Mapping Color">
                    <Image Source="/Assets/Icons/SectionMapping.png" Width="48" Height="48"/>
                </Button>

                <!-- 9. Reset Tool Heading -->
                <Button Width="58" Height="58" Background="Transparent" BorderThickness="0" Padding="5"
                        ToolTip.Tip="Reset Tool Heading">
                    <Image Source="/Assets/Icons/ResetTool.png" Width="48" Height="48"/>
                </Button>

                <!-- 8. Tram Display Mode toggle -->
                <Button Width="58" Height="58" Background="Transparent" BorderThickness="0" Padding="5"
                        ToolTip.Tip="Tram Display">
                    <Image Source="/Assets/Icons/TramOff.png" Width="48" Height="48"/>
                </Button>

                <!-- 7. Hydraulic Lift toggle -->
                <Button Width="58" Height="58" Background="Transparent" BorderThickness="0" Padding="5"
                        ToolTip.Tip="Hydraulic Lift">
                    <Image Source="/Assets/Icons/HydraulicLiftOff.png" Width="48" Height="48"/>
                </Button>

                <!-- 6. Headland On/Off toggle -->
                <Button Width="58" Height="58" Background="Transparent" BorderThickness="0" Padding="5"
                        ToolTip.Tip="Headland Mode">
                    <Image Source="/Assets/Icons/HeadlandOff.png" Width="48" Height="48"/>
                </Button>

                <!-- 5. Flag/Marker -->
                <Button Width="58" Height="58" Background="Transparent" BorderThickness="0" Padding="5"
                        ToolTip.Tip="Drop Marker Flags">
                    <Image Source="/Assets/Icons/FlagRed.png" Width="48" Height="48"/>
                </Button>

                <!-- 4. Adjust Left -->
                <Button Width="58" Height="58" Background="Transparent" BorderThickness="0" Padding="5"
                        ToolTip.Tip="Snap Left">
                    <Image Source="/Assets/Icons/SnapLeft.png" Width="48" Height="48"/>
                </Button>

                <!-- 3. Adjust Right -->
                <Button Width="58" Height="58" Background="Transparent" BorderThickness="0" Padding="5"
                        ToolTip.Tip="Snap Right">
                    <Image Source="/Assets/Icons/SnapRight.png" Width="48" Height="48"/>
                </Button>

                <!-- 2. Snap to Pivot -->
                <Button Width="58" Height="58" Background="Transparent" BorderThickness="0" Padding="5"
                        ToolTip.Tip="Snap to Pivot">
                    <Image Source="/Assets/Icons/SnapToPivot.png" Width="48" Height="48"/>
                </Button>

                <!-- 1. Track mode toggle -->
                <Button Width="58" Height="58" Background="Transparent" BorderThickness="0" Padding="5"
                        ToolTip.Tip="Track Mode">
                    <Image Source="/Assets/Icons/TrackOn.png" Width="48" Height="48"/>
                </Button>
                </StackPanel>
            </Border>
        </Grid>

        <!-- Panel Navigation: Floating Border (179×460px, initially hidden) -->
        <Border Grid.Row="1"
                x:Name="PanelNavigation"
                IsVisible="False"
                Background="#1a1a1a"
                Width="179" Height="460"
                HorizontalAlignment="Left"
                VerticalAlignment="Top"
                Margin="100,80,0,0"
                CornerRadius="4"
                BoxShadow="0 4 8 0 #40000000">
            <Grid RowDefinitions="*,*,*,*,*" ColumnDefinitions="*,*">

                <!-- Row 0: Camera Tilt Controls -->
                <Button Grid.Row="0" Grid.Column="0"
                        Classes="NavButton"
                        Command="{Binding TiltDownCommand}"
                        ToolTip.Tip="Tilt camera down">
                    <Image Source="/Assets/Icons/TiltDown.png" Width="48" Height="48"/>
                </Button>
                <Button Grid.Row="0" Grid.Column="1"
                        Classes="NavButton"
                        Command="{Binding TiltUpCommand}"
                        ToolTip.Tip="Tilt camera up">
                    <Image Source="/Assets/Icons/TiltUp.png" Width="48" Height="48"/>
                </Button>

                <!-- Row 1: 2D/3D View Controls -->
                <Button Grid.Row="1" Grid.Column="0"
                        Classes="NavButton"
                        Command="{Binding Camera2DCommand}"
                        ToolTip.Tip="Switch to 2D overhead view">
                    <Image Source="/Assets/Icons/Camera2D64.png" Width="48" Height="48"/>
                </Button>
                <Button Grid.Row="1" Grid.Column="1"
                        Classes="NavButton"
                        Command="{Binding Camera3DCommand}"
                        ToolTip.Tip="Switch to 3D perspective view">
                    <Image Source="/Assets/Icons/Camera3D64.png" Width="48" Height="48"/>
                </Button>

                <!-- Row 2: North Lock and Grid Controls -->
                <Button Grid.Row="2" Grid.Column="0"
                        Classes="NavButton"
                        Command="{Binding CameraNorth2DCommand}"
                        ToolTip.Tip="Switch to North-locked 2D view">
                    <Image Source="/Assets/Icons/CameraNorth2D.png" Width="48" Height="48"/>
                </Button>
                <Button Grid.Row="2" Grid.Column="1"
                        Classes="NavButton"
                        Command="{Binding ToggleGridCommand}"
                        ToolTip.Tip="Toggle grid display">
                    <Image Source="/Assets/Icons/GridRotate.png" Width="64" Height="64"/>
                </Button>

                <!-- Row 3: Day/Night Mode and Hz Display -->
                <Button Grid.Row="3" Grid.Column="0"
                        Classes="NavButton"
                        Command="{Binding ToggleDayNightCommand}"
                        ToolTip.Tip="Toggle day/night display mode">
                    <Image Source="/Assets/Icons/WindowNightMode.png" Width="48" Height="48"/>
                </Button>
                <TextBlock Grid.Row="3" Grid.Column="1"
                          Text="60 Hz"
                          HorizontalAlignment="Center"
                          VerticalAlignment="Center"
                          FontSize="14"
                          FontWeight="Bold"
                          Foreground="#333"/>

                <!-- Row 4: Brightness Controls -->
                <Button Grid.Row="4" Grid.Column="0"
                        Classes="NavButton"
                        Command="{Binding BrightnessDownCommand}"
                        ToolTip.Tip="Decrease brightness">
                    <StackPanel>
                        <Image Source="/Assets/Icons/BrightnessDn.png" Width="48" Height="48"/>
                        <TextBlock Text="20%"
                                  HorizontalAlignment="Center"
                                  FontSize="10"
                                  FontWeight="Bold"
                                  Foreground="#333"
                                  Margin="0,4,0,0"/>
                    </StackPanel>
                </Button>
                <Button Grid.Row="4" Grid.Column="1"
                        Classes="NavButton"
                        Command="{Binding BrightnessUpCommand}"
                        ToolTip.Tip="Increase brightness">
                    <Image Source="/Assets/Icons/BrightnessUp.png" Width="48" Height="48"/>
                </Button>
            </Grid>
        </Border>
    </Grid>
</Window>
