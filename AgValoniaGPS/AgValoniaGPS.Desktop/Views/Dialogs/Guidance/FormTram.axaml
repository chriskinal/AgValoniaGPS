<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:AgValoniaGPS.ViewModels.Dialogs.Guidance;assembly=AgValoniaGPS.ViewModels"
        x:Class="AgValoniaGPS.Desktop.Views.Dialogs.Guidance.FormTram"
        x:DataType="vm:TramViewModel"
        Title="Tram Line Configuration"
        Width="550" Height="600"
        WindowStartupLocation="CenterScreen">

    <Grid RowDefinitions="Auto,*,Auto" Margin="16">
        <TextBlock Grid.Row="0" Text="Tram Line Configuration" FontSize="18" FontWeight="Bold" Margin="0,0,0,16"/>

        <ScrollViewer Grid.Row="1">
            <StackPanel Spacing="16">
                <!-- Tram Pattern Selection -->
                <StackPanel Spacing="4">
                    <TextBlock Text="Tram Line Pattern" FontWeight="SemiBold"/>
                    <ListBox ItemsSource="{Binding Patterns}"
                             SelectedItem="{Binding SelectedPattern}"
                             MinHeight="200">
                        <ListBox.ItemTemplate>
                            <DataTemplate DataType="vm:TramLinePattern">
                                <StackPanel Orientation="Horizontal" Spacing="12">
                                    <TextBlock Text="{Binding Name}" FontWeight="SemiBold" VerticalAlignment="Center"/>
                                    <TextBlock Text="{Binding Description}" Foreground="#666" VerticalAlignment="Center"/>
                                </StackPanel>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </StackPanel>

                <!-- Tram Spacing -->
                <StackPanel Spacing="4">
                    <TextBlock Text="Tram Spacing (Implement Width Multiplier)" FontWeight="SemiBold"/>
                    <Slider Value="{Binding TramSpacing}" Minimum="1" Maximum="12" TickFrequency="1" MinHeight="36"/>
                    <Grid ColumnDefinitions="*,*" ColumnSpacing="8">
                        <TextBlock Grid.Column="0" Text="{Binding TramSpacingFormatted}" FontSize="14"/>
                        <TextBlock Grid.Column="1" Text="{Binding ActualSpacingFormatted}" FontSize="14" Foreground="#666"/>
                    </Grid>
                </StackPanel>

                <!-- Implement Passes -->
                <StackPanel Spacing="4">
                    <TextBlock Text="Implement Passes Between Tram Lines" FontWeight="SemiBold"/>
                    <NumericUpDown Value="{Binding ImplementPasses}" Minimum="1" Maximum="12" MinHeight="36"/>
                    <TextBlock Text="{Binding ImplementPassesDisplay}" FontSize="12" Foreground="#888"/>
                </StackPanel>

                <!-- Show Tram Lines -->
                <CheckBox IsChecked="{Binding ShowTramLines}" Content="Show Tram Lines" FontSize="14" MinHeight="36"/>

                <!-- Action Buttons -->
                <StackPanel Spacing="8">
                    <Button Content="Generate Tram Lines" Command="{Binding GenerateTramLinesCommand}" MinHeight="36" FontSize="14"/>
                    <Button Content="Clear Tram Lines" Command="{Binding ClearTramLinesCommand}" MinHeight="36" FontSize="14"/>
                </StackPanel>

                <TextBlock Text="{Binding ErrorMessage}" IsVisible="{Binding HasError}" Foreground="Red" TextWrapping="Wrap"/>
            </StackPanel>
        </ScrollViewer>

        <StackPanel Grid.Row="2" Orientation="Horizontal" Spacing="8" HorizontalAlignment="Right" Margin="0,16,0,0">
            <Button Content="OK" Command="{Binding OKCommand}" MinWidth="80" MinHeight="36"/>
            <Button Content="Cancel" Command="{Binding CancelCommand}" MinWidth="80" MinHeight="36"/>
        </StackPanel>
    </Grid>
</Window>
