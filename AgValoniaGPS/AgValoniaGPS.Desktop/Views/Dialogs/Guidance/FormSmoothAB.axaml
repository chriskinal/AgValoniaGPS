<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:AgValoniaGPS.ViewModels.Dialogs.Guidance;assembly=AgValoniaGPS.ViewModels"
        x:Class="AgValoniaGPS.Desktop.Views.Dialogs.Guidance.FormSmoothAB"
        x:DataType="vm:SmoothABViewModel"
        Title="Smooth AB Line"
        Width="600" Height="500"
        WindowStartupLocation="CenterScreen">

    <Grid RowDefinitions="Auto,*,Auto" Margin="16">
        <TextBlock Grid.Row="0" Text="Smooth AB Line" FontSize="18" FontWeight="Bold" Margin="0,0,0,16"/>

        <ScrollViewer Grid.Row="1">
            <StackPanel Spacing="16">
                <!-- Smoothing Tolerance -->
                <StackPanel Spacing="4">
                    <TextBlock Text="Smoothing Tolerance" FontWeight="SemiBold"/>
                    <Slider Value="{Binding SmoothingTolerance}" Minimum="0.1" Maximum="10" MinHeight="36"/>
                    <TextBlock Text="{Binding SmoothingTolerance, StringFormat='{}{0:F1} m'}" FontSize="14"/>
                </StackPanel>

                <!-- Point Counts -->
                <Grid ColumnDefinitions="*,*" ColumnSpacing="16">
                    <Border Grid.Column="0" BorderBrush="#CCC" BorderThickness="1" Padding="12" CornerRadius="4">
                        <StackPanel Spacing="4">
                            <TextBlock Text="Original" FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding OriginalPointCountDisplay}" FontSize="16"/>
                        </StackPanel>
                    </Border>
                    <Border Grid.Column="1" BorderBrush="#CCC" BorderThickness="1" Padding="12" CornerRadius="4">
                        <StackPanel Spacing="4">
                            <TextBlock Text="Smoothed" FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding SmoothedPointCountDisplay}" FontSize="16"/>
                        </StackPanel>
                    </Border>
                </Grid>

                <TextBlock Text="{Binding ReductionPercentageDisplay}" FontSize="14" HorizontalAlignment="Center"/>

                <!-- Action Buttons -->
                <StackPanel Spacing="8">
                    <Button Content="Preview Smoothing" Command="{Binding PreviewSmoothingCommand}" MinHeight="36" FontSize="14"/>
                    <Button Content="Apply Smoothing" Command="{Binding ApplySmoothingCommand}" MinHeight="36" FontSize="14"/>
                    <Button Content="Reset" Command="{Binding ResetCommand}" MinHeight="36" FontSize="14"/>
                </StackPanel>

                <TextBlock Text="{Binding ErrorMessage}" IsVisible="{Binding HasError}" Foreground="Red" TextWrapping="Wrap"/>
            </StackPanel>
        </ScrollViewer>

        <StackPanel Grid.Row="2" Orientation="Horizontal" Spacing="8" HorizontalAlignment="Right" Margin="0,16,0,0">
            <Button Content="OK" Command="{Binding OKCommand}" MinWidth="80" MinHeight="36"/>
            <Button Content="Cancel" Command="{Binding CancelCommand}" MinWidth="80" MinHeight="36"/>
        </StackPanel>
    </Grid>
</Window>
