<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:AgValoniaGPS.ViewModels.Panels.FieldManagement"
             x:Class="AgValoniaGPS.Desktop.Views.Panels.FieldManagement.FormCamera"
             x:DataType="vm:FormCameraViewModel">

    <Border Classes="FloatingPanel" Width="220" MinHeight="280">
        <StackPanel Spacing="15">
            <!-- Header -->
            <Grid Height="32" Margin="0,0,0,8">
                <!-- Drag handle and title -->
                <StackPanel Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                    <TextBlock Text="≡" Foreground="#888" FontSize="16" FontWeight="Bold"
                               VerticalAlignment="Center" ToolTip.Tip="Drag to move panel"/>
                    <TextBlock Text="{Binding Title}"
                               FontWeight="Bold"
                               FontSize="18"
                               Foreground="White"
                               VerticalAlignment="Center"/>
                </StackPanel>
                <!-- Close button (absolutely positioned in top-right) -->
                <Button Classes="IconButton"
                        Content="×"
                        Width="32"
                        Height="32"
                        FontSize="20"
                        Command="{Binding CloseCommand}"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Top"/>
            </Grid>

            <!-- Zoom Controls -->
            <Border Classes="StatusBox">
                <StackPanel Spacing="10">
                    <TextBlock Text="Zoom" Foreground="#AAA" FontSize="12"/>

                    <StackPanel Orientation="Horizontal" Spacing="8" HorizontalAlignment="Center">
                        <Button Classes="ModernButton"
                                Content="-"
                                Command="{Binding ZoomOutCommand}"
                                Width="50"
                                Height="40"
                                FontSize="20"
                                FontWeight="Bold"/>

                        <TextBlock Text="{Binding ZoomLevel, StringFormat='F1x'}"
                                   Foreground="White"
                                   FontSize="16"
                                   VerticalAlignment="Center"
                                   Width="50"
                                   TextAlignment="Center"/>

                        <Button Classes="ModernButton"
                                Content="+"
                                Command="{Binding ZoomInCommand}"
                                Width="50"
                                Height="40"
                                FontSize="20"
                                FontWeight="Bold"/>
                    </StackPanel>

                    <Slider Value="{Binding ZoomLevel}"
                            Minimum="1"
                            Maximum="20"
                            TickFrequency="1"
                            IsSnapToTickEnabled="False"
                            HorizontalAlignment="Stretch"/>
                </StackPanel>
            </Border>

            <!-- Camera Mode -->
            <Border Classes="StatusBox">
                <StackPanel Spacing="8">
                    <TextBlock Text="Camera Mode" Foreground="#AAA" FontSize="12"/>

                    <StackPanel Spacing="5">
                        <RadioButton Content="Auto Follow"
                                     IsChecked="{Binding CameraMode}"
                                     GroupName="CameraMode"
                                     Foreground="White"/>
                        <RadioButton Content="Manual"
                                     GroupName="CameraMode"
                                     Foreground="White"/>
                        <RadioButton Content="North-Up"
                                     GroupName="CameraMode"
                                     Foreground="White"/>
                        <RadioButton Content="Heading-Up"
                                     GroupName="CameraMode"
                                     Foreground="White"/>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Action Buttons -->
            <StackPanel Spacing="8">
                <Button Classes="ModernButton"
                        Content="Zoom to Fit Field"
                        Command="{Binding ZoomToFitCommand}"
                        HorizontalAlignment="Stretch"
                        Height="35"/>
                <Button Classes="ModernButton"
                        Content="Reset Camera"
                        Command="{Binding ResetCameraCommand}"
                        HorizontalAlignment="Stretch"
                        Height="35"
                        Background="#E67E22"/>
            </StackPanel>

            <!-- Follow Toggle -->
            <Border Classes="StatusBox">
                <StackPanel Spacing="5">
                    <TextBlock Text="Following Vehicle"
                               Foreground="White"
                               FontSize="12"
                               FontWeight="Bold"
                               HorizontalAlignment="Center"/>
                    <TextBlock Text="{Binding IsFollowingVehicle}"
                               Foreground="White"
                               HorizontalAlignment="Center"/>
                </StackPanel>
            </Border>

            <!-- Error Message -->
            <Border Classes="StatusBox"
                    Background="#99E74C3C"
                    IsVisible="{Binding HasError}">
                <TextBlock Text="{Binding ErrorMessage}"
                           Foreground="White"
                           FontSize="12"
                           TextWrapping="Wrap"/>
            </Border>
        </StackPanel>
    </Border>
</UserControl>
